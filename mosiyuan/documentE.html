<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>文档E</title>
		<style>
			body{
				tab-size:4;
			}
		</style>
	</head>
	<body>
<pre><code class="language-cpp"><span class="hljs-comment">/**
 * Поклонение симулятору Сиюань
 * Уровень 3 Истина до уровня 4 Истина
 * Ты силен для тебя, я никогда не покажу слабости!
 * Используйте Google Translate. Я не знаю русского, не бей меня!
 */</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">dist_t</span>;

<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> COST_MIN = <span class="hljs-number">160</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> COST_MAX = <span class="hljs-number">220</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> RESOURCE_COUNT = <span class="hljs-number">3</span>;
<span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> RESOURCE_NAMES[RESOURCE_COUNT] = {
	<span class="hljs-string">"драгоценный камень"</span>,
	<span class="hljs-string">"Волшебный камень"</span>,
	<span class="hljs-string">"объектив"</span>,																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										  };<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">abs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{<span class="hljs-comment">/*机惨*/</span><span class="hljs-keyword">return</span> (<span class="hljs-keyword">unsigned</span>)x;}<span class="hljs-class"><span class="hljs-keyword">struct</span> _																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										  
	/* "кристалл", */																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										 {</span>																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										  
};

<span class="hljs-keyword">template</span> &lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;
<span class="hljs-title">class</span> <span class="hljs-title">RandomGen</span>
{</span>
	T _min, _max;
	<span class="hljs-keyword">size_t</span> _range;

<span class="hljs-keyword">public</span>:
	RandomGen(T __min, T __max) : _min(__min), _max(__max)
	{
		_range = _max - _min;
	}
	<span class="hljs-function">T <span class="hljs-title">random</span><span class="hljs-params">()</span>
	</span>{
		<span class="hljs-keyword">return</span> rand() % _range + _min;
	}
	<span class="hljs-function"><span class="hljs-keyword">inline</span> T <span class="hljs-title">min</span><span class="hljs-params">()</span>
	</span>{
		<span class="hljs-keyword">return</span> _min;
	}
	<span class="hljs-function"><span class="hljs-keyword">inline</span> T <span class="hljs-title">max</span><span class="hljs-params">()</span>
	</span>{
		<span class="hljs-keyword">return</span> _max;
	}
};

<span class="hljs-comment">/* Ресурс */</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Resource</span>
{</span>
	<span class="hljs-built_in">string</span> name;
	Resource(<span class="hljs-built_in">string</span> _name) : name(_name) {}
};

<span class="hljs-comment">/* лаборатория */</span>
<span class="hljs-keyword">template</span> &lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RNG</span>, <span class="hljs-title">int</span> <span class="hljs-title">MIN</span>, <span class="hljs-title">int</span> <span class="hljs-title">MAX</span>&gt;
<span class="hljs-title">class</span> <span class="hljs-title">Lab</span>
{</span>
	<span class="hljs-built_in">vector</span>&lt;Resource&gt; resourceList;
	RNG *needGen;
	<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; needList;

<span class="hljs-keyword">public</span>:
	Lab()
	{
		needGen = <span class="hljs-keyword">new</span> RNG(MIN, MAX);
	}
	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">registerResource</span><span class="hljs-params">(Resource res)</span>
	</span>{
		resourceList.push_back(res);
		needList.push_back(needGen-&gt;random());
	}
	<span class="hljs-keyword">size_t</span> size()
	{
		<span class="hljs-keyword">return</span> resourceList.size();
	}
	<span class="hljs-keyword">dist_t</span> run(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; (*query)(<span class="hljs-keyword">dist_t</span> dist))
	{
		<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> DIS_MOD = <span class="hljs-number">9</span>;
		<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; result;
		<span class="hljs-keyword">int</span> totalTime = <span class="hljs-number">0</span>;
		<span class="hljs-comment">/* Очевидно, разрыв всегда неотрицателен. */</span>
		<span class="hljs-keyword">dist_t</span> lastDist = <span class="hljs-number">0</span>;
		<span class="hljs-keyword">do</span>
		{
			totalTime++;
			result = query(lastDist);
			lastDist = <span class="hljs-number">0</span>;
			<span class="hljs-keyword">for</span> (<span class="hljs-keyword">size_t</span> i = <span class="hljs-number">0</span>; i &lt; size(); i++)
			{
				<span class="hljs-keyword">dist_t</span> offset = <span class="hljs-built_in">abs</span>(needList[i] - result[i]);
				lastDist ^= offset;
			}
			lastDist %= DIS_MOD;
			<span class="hljs-comment">/* Предотвратить общий разрыв равным 0 */</span>
			lastDist += <span class="hljs-number">1</span>;
		} <span class="hljs-keyword">while</span> (result != needList);
		<span class="hljs-keyword">return</span> totalTime;
	}
};

<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; ask(<span class="hljs-keyword">dist_t</span> lastDist)
{
	<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; input;
	<span class="hljs-keyword">if</span> (lastDist != <span class="hljs-number">0</span>)
	{
		<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"Последнее расстояние было "</span> &lt;&lt; lastDist &lt;&lt; <span class="hljs-string">"."</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
	}
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; RESOURCE_COUNT; i++)
	{
		<span class="hljs-keyword">int</span> value;
		<span class="hljs-keyword">do</span>
		{
			<span class="hljs-built_in">cout</span> &lt;&lt; RESOURCE_NAMES[i] &lt;&lt; <span class="hljs-string">":"</span>;
			<span class="hljs-built_in">cin</span> &gt;&gt; value;
		} <span class="hljs-keyword">while</span> (value &lt; COST_MIN || value &gt; COST_MAX);
		input.push_back(value);
	}
	<span class="hljs-keyword">return</span> input;
}

<span class="hljs-function"><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> <span class="hljs-title">doExperiment</span><span class="hljs-params">()</span>
</span>{
	Lab&lt;RandomGen&lt;<span class="hljs-keyword">int</span>&gt;, COST_MIN, COST_MAX&gt; currentLab;
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; RESOURCE_COUNT; i++)
	{
		currentLab.registerResource(Resource(RESOURCE_NAMES[i]));
	}
	<span class="hljs-keyword">return</span> currentLab.run(ask);
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>;; i++)
	{
		<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"Раунд "</span> &lt;&lt; i &lt;&lt; <span class="hljs-built_in">endl</span>;
		<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> time = doExperiment();
		<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"Использовано "</span> &lt;&lt; time &lt;&lt; <span class="hljs-string">" попытки."</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
	}
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

<span class="hljs-comment">/**
 * В этом приложении есть ошибка.
 * Но последний человек, который принял программу,
 * был слишком ересью, я не буду это исправлять для него!
 * Пусть он окажется в ловушке этой ошибки!
 * - LMOliver
 */</span></code></pre>
	<script>
		function loadCSS(href,...backUps){
			let element=document.createElement('link');
			element.setAttribute('rel','stylesheet');
			element.setAttribute('href',href);
			element.addEventListener('error',(e)=>{
				if(backUps.length>0){
					loadCSS(...backUps);
				}
				else{
					throw e;
				}
			});
			document.body.appendChild(element);
		}
		loadCSS('https://cdn.jsdelivr.net/gh/lmoliver/lmoliver.github.io@master/normalize.min.css','../normalize.css');
	</script>
	</body>
	
</html>
